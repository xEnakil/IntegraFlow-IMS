basePath: /
definitions:
  domain.Action:
    properties:
      createdAt:
        type: string
      description:
        type: string
      dueDate:
        description: YYYY-MM-DD
        type: string
      id:
        type: integer
      owner:
        type: string
      sourceId:
        type: integer
      sourceType:
        description: Risk, Incident, Audit
        type: string
      status:
        description: Open, In Progress, Done, Overdue
        type: string
      title:
        type: string
      updatedAt:
        type: string
    type: object
  domain.Audit:
    properties:
      auditor:
        type: string
      createdAt:
        type: string
      domain:
        allOf:
        - $ref: '#/definitions/domain.Domain'
        description: Main focus area
      findings:
        description: Text field
        type: string
      id:
        type: integer
      plannedDate:
        description: YYYY-MM-DD
        type: string
      scope:
        type: string
      status:
        description: Planned, In Progress, Completed
        type: string
      title:
        type: string
    type: object
  domain.Dashboard:
    properties:
      actionsByStatus:
        additionalProperties:
          type: integer
        type: object
      highRisks:
        type: integer
      incidentsByDomain:
        additionalProperties:
          type: integer
        type: object
      openIncidents:
        type: integer
      totalIncidents:
        type: integer
      totalRisks:
        type: integer
    type: object
  domain.Domain:
    enum:
    - Quality
    - Environment
    - OHS
    - Information Security
    type: string
    x-enum-comments:
      DomainEnv: ISO 14001
      DomainISMS: ISMS / ISO 27001
      DomainOHS: ISO 45001
      DomainQuality: ISO 9001
    x-enum-descriptions:
    - ISO 9001
    - ISO 14001
    - ISO 45001
    - ISMS / ISO 27001
    x-enum-varnames:
    - DomainQuality
    - DomainEnv
    - DomainOHS
    - DomainISMS
  domain.Incident:
    properties:
      createdAt:
        description: RFC3339
        type: string
      description:
        type: string
      domain:
        $ref: '#/definitions/domain.Domain'
      id:
        type: integer
      likelihood:
        description: 1-5
        type: integer
      relatedRiskId:
        type: integer
      riskLevel:
        description: Low/Medium/High
        type: string
      riskScore:
        type: integer
      rootCause:
        type: string
      severity:
        description: 1-5
        type: integer
      status:
        description: Open, Investigation, Closed
        type: string
      title:
        type: string
      updatedAt:
        description: RFC3339
        type: string
    type: object
  domain.Risk:
    properties:
      createdAt:
        description: RFC3339 timestamp
        type: string
      description:
        description: Detailed description
        type: string
      domain:
        allOf:
        - $ref: '#/definitions/domain.Domain'
        description: IMS Domain (Quality/Environment/OHS/Information Security)
      id:
        description: Auto-generated risk ID
        type: integer
      impact:
        description: 1-5
        type: integer
      level:
        description: Low/Medium/High
        type: string
      likelihood:
        description: 1-5
        type: integer
      owner:
        description: Responsible person / role
        type: string
      process:
        description: Process where risk occurs
        type: string
      score:
        description: Likelihood * Impact
        type: integer
      status:
        description: Open, Accepted, Mitigated
        type: string
      title:
        description: Short risk title
        type: string
    type: object
  httpapi.CreateActionRequest:
    properties:
      description:
        type: string
      dueDate:
        description: YYYY-MM-DD
        type: string
      owner:
        type: string
      sourceId:
        type: integer
      sourceType:
        description: risk|incident|audit
        type: string
      title:
        type: string
    type: object
  httpapi.CreateAuditRequest:
    properties:
      auditor:
        type: string
      domain:
        description: quality|environment|ohs|isms
        type: string
      plannedDate:
        description: YYYY-MM-DD
        type: string
      scope:
        type: string
      title:
        type: string
    type: object
  httpapi.CreateIncidentRequest:
    properties:
      description:
        type: string
      domain:
        description: quality|environment|ohs|isms
        type: string
      likelihood:
        description: 1-5
        type: integer
      relatedRiskId:
        description: Optional link to risk
        type: integer
      severity:
        description: 1-5
        type: integer
      title:
        type: string
    type: object
  httpapi.CreateRiskRequest:
    properties:
      description:
        description: Detailed risk description
        type: string
      domain:
        description: 'Domain: quality|environment|ohs|isms'
        type: string
      impact:
        description: 1 (minor) - 5 (catastrophic)
        type: integer
      likelihood:
        description: 1 (rare) - 5 (almost certain)
        type: integer
      owner:
        description: Responsible person or role
        type: string
      process:
        description: Process where the risk occurs
        type: string
      title:
        description: Short name of the risk
        type: string
    type: object
  httpapi.UpdateActionRequest:
    properties:
      dueDate:
        description: Optional new due date
        type: string
      status:
        description: Open, In Progress, Done, Overdue
        type: string
    type: object
  httpapi.UpdateAuditRequest:
    properties:
      findings:
        description: Summary of audit findings
        type: string
      status:
        description: Planned, In Progress, Completed
        type: string
    type: object
  httpapi.UpdateIncidentRequest:
    properties:
      rootCause:
        type: string
      status:
        description: Open, Investigation, Closed
        type: string
    type: object
  httpapi.UpdateRiskStatusRequest:
    properties:
      status:
        description: Open, Accepted, Mitigated
        type: string
    type: object
info:
  contact:
    email: ims@example.com
    name: IntegraFlow IMS Team
  description: Integrated Management System API for risks, incidents, audits and CAPA.
  title: IntegraFlow IMS API
  version: "1.0"
paths:
  /api/actions:
    get:
      description: Returns actions, optionally filtered by status or source type.
      parameters:
      - description: Status filter (Open|In Progress|Done|Overdue)
        in: query
        name: status
        type: string
      - description: Source type filter (Risk|Incident|Audit)
        in: query
        name: sourceType
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/domain.Action'
            type: array
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: List actions
      tags:
      - actions
    post:
      consumes:
      - application/json
      description: Creates a corrective/preventive action linked to a risk, incident
        or audit.
      parameters:
      - description: Action payload
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/httpapi.CreateActionRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/domain.Action'
        "400":
          description: Bad Request
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Create CAPA action
      tags:
      - actions
  /api/actions/{id}:
    put:
      consumes:
      - application/json
      description: Updates the status and/or due date of an action.
      parameters:
      - description: Action ID
        in: path
        name: id
        required: true
        type: integer
      - description: Update payload
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/httpapi.UpdateActionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.Action'
        "400":
          description: Bad Request
          schema:
            type: string
        "404":
          description: Not Found
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Update action
      tags:
      - actions
  /api/audits:
    get:
      description: Returns internal audits, optionally filtered by status.
      parameters:
      - description: Status filter (Planned|In Progress|Completed)
        in: query
        name: status
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/domain.Audit'
            type: array
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: List audits
      tags:
      - audits
    post:
      consumes:
      - application/json
      description: Creates a new IMS internal audit record.
      parameters:
      - description: Audit payload
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/httpapi.CreateAuditRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/domain.Audit'
        "400":
          description: Bad Request
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Create internal audit
      tags:
      - audits
  /api/audits/{id}:
    put:
      consumes:
      - application/json
      description: Updates audit status and/or findings.
      parameters:
      - description: Audit ID
        in: path
        name: id
        required: true
        type: integer
      - description: Update payload
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/httpapi.UpdateAuditRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.Audit'
        "400":
          description: Bad Request
          schema:
            type: string
        "404":
          description: Not Found
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Update audit
      tags:
      - audits
  /api/dashboard:
    get:
      description: Returns aggregated IMS KPIs (risks, incidents, actions).
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.Dashboard'
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Get IMS dashboard
      tags:
      - dashboard
  /api/incidents:
    get:
      description: Returns incidents, optionally filtered by domain and status.
      parameters:
      - description: Domain filter
        in: query
        name: domain
        type: string
      - description: Status filter (Open|Investigation|Closed)
        in: query
        name: status
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/domain.Incident'
            type: array
        "400":
          description: Bad Request
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: List incidents
      tags:
      - incidents
    post:
      consumes:
      - application/json
      description: Records an incident/nonconformity in the IMS.
      parameters:
      - description: Incident payload
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/httpapi.CreateIncidentRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/domain.Incident'
        "400":
          description: Bad Request
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Create a new incident
      tags:
      - incidents
  /api/incidents/{id}:
    get:
      description: Returns a single incident by ID.
      parameters:
      - description: Incident ID
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.Incident'
        "404":
          description: Not Found
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Get incident
      tags:
      - incidents
    put:
      consumes:
      - application/json
      description: Updates root cause and/or status of an incident.
      parameters:
      - description: Incident ID
        in: path
        name: id
        required: true
        type: integer
      - description: Update payload
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/httpapi.UpdateIncidentRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.Incident'
        "400":
          description: Bad Request
          schema:
            type: string
        "404":
          description: Not Found
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Update incident
      tags:
      - incidents
  /api/risks:
    get:
      description: Returns all risks, optionally filtered by IMS domain and status.
      parameters:
      - description: Domain filter (quality|environment|ohs|isms)
        in: query
        name: domain
        type: string
      - description: Status filter (Open|Accepted|Mitigated)
        in: query
        name: status
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/domain.Risk'
            type: array
        "400":
          description: Bad Request
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: List risks
      tags:
      - risks
    post:
      consumes:
      - application/json
      description: Creates a new IMS risk and calculates its risk score and level.
      parameters:
      - description: Risk payload
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/httpapi.CreateRiskRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/domain.Risk'
        "400":
          description: Bad Request
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Create a new risk
      tags:
      - risks
  /api/risks/{id}:
    put:
      consumes:
      - application/json
      description: Updates the status of an existing risk.
      parameters:
      - description: Risk ID
        in: path
        name: id
        required: true
        type: integer
      - description: New status
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/httpapi.UpdateRiskStatusRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.Risk'
        "400":
          description: Bad Request
          schema:
            type: string
        "404":
          description: Not Found
          schema:
            type: string
        "500":
          description: Internal Server Error
          schema:
            type: string
      summary: Update risk status
      tags:
      - risks
swagger: "2.0"
